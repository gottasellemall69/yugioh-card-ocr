(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(9151)}])},9151:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return C}});var r=t(5893),s=t(7294),l=t(9008),n=t.n(l);function c(){return(0,r.jsxs)("div",{className:"text-center mb-8 animate-fade-in",children:[(0,r.jsx)("h1",{className:"text-4xl md:text-5xl font-bold mb-2 bg-gradient-to-r from-primary to-purple-600 bg-clip-text text-transparent",children:"Yu-Gi-Oh Card Recognition"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-lg max-w-2xl mx-auto",children:"Upload card images to automatically recognize and match them against your inventory using advanced OCR technology"}),(0,r.jsxs)("div",{className:"mt-4 flex justify-center space-x-4 text-sm text-gray-500",children:[(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"OCR Processing"]}),(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),"Database Matching"]}),(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"w-2 h-2 bg-purple-500 rounded-full mr-2"}),"Price Fetching"]})]})]})}var d=t(7460),i=t.n(d);function o(e){let{uploadedImages:a,setUploadedImages:t,inventory:l,setInventory:n,isProcessing:c}=e,[d,o]=(0,s.useState)({show:!1,count:0,size:""}),[m,g]=(0,s.useState)(!1),h=(0,s.useRef)(null),x=(0,s.useRef)(null),u=e=>{let a=Array.from(e).filter(e=>e.type.startsWith("image/"));t(a),p(a),console.log("Selected ".concat(a.length," images"))},p=e=>{if(e.length>0){let a=e.reduce((e,a)=>e+a.size,0),t=a<1048576?"".concat((a/1024).toFixed(1)," KB"):"".concat((a/1024/1024).toFixed(1)," MB");o({show:!0,count:e.length,size:t})}else o({show:!1,count:0,size:""})};return(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8 animate-slide-up",children:[(0,r.jsxs)("h2",{className:"text-2xl font-semibold mb-6 flex items-center",children:[(0,r.jsx)("span",{className:"mr-3",children:"\uD83D\uDCC1"}),"Upload Files"]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Inventory CSV (optional)"}),(0,r.jsx)("input",{ref:x,type:"file",accept:".csv",onChange:e=>{let a=e.target.files[0];a&&i().parse(a,{complete:e=>{let a=e.data.filter(e=>e.some(e=>e&&e.trim()));n(a),console.log("Loaded ".concat(a.length," items from inventory"))},error:e=>{console.error("CSV parse error: ".concat(e.message))}})},disabled:c,className:"w-full text-base p-3 border border-gray-300 dark:border-gray-600 rounded-lg  bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-white hover:file:bg-purple-600 disabled:opacity-50"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Upload your existing inventory CSV file for enhanced matching"}),l.length>0&&(0,r.jsxs)("div",{className:"mt-2 text-sm text-green-600 dark:text-green-400",children:["✅ Loaded ",l.length," inventory items"]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Card Images"}),(0,r.jsxs)("div",{onClick:()=>{var e;return!c&&(null===(e=h.current)||void 0===e?void 0:e.click())},onDrop:e=>{e.preventDefault(),g(!1),u(e.dataTransfer.files)},onDragOver:e=>{e.preventDefault(),g(!0)},onDragLeave:e=>{e.preventDefault(),g(!1)},className:"border-2 border-dashed rounded-lg p-8 text-center transition-all duration-300 cursor-pointer\n                     ".concat(m?"border-primary bg-primary/5":"border-gray-300 dark:border-gray-600","\n                     ").concat(c?"opacity-50 cursor-not-allowed":"hover:border-primary hover:bg-primary/5","\n                     group"),children:[(0,r.jsx)("div",{className:"text-4xl mb-4 group-hover:scale-110 transition-transform",children:c?"⏳":"\uD83D\uDCF8"}),(0,r.jsx)("p",{className:"text-lg mb-2 font-medium",children:c?"Processing...":"Drop card images here or click to browse"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Supports JPG, PNG, WebP - Multiple files supported"}),(0,r.jsx)("input",{ref:h,type:"file",multiple:!0,accept:"image/*",onChange:e=>u(e.target.files),disabled:c,className:"hidden"})]}),d.show&&(0,r.jsx)("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800 animate-fade-in",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{className:"font-semibold text-blue-800 dark:text-blue-200",children:[d.count," images selected"]}),(0,r.jsxs)("span",{className:"text-sm text-blue-600 dark:text-blue-300 ml-2",children:["(",d.size,")"]})]}),(0,r.jsx)("button",{onClick:()=>{t([]),o({show:!1,count:0,size:""}),h.current&&(h.current.value=""),console.log("Cleared all images from batch")},disabled:c,className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 text-sm px-3 py-1 rounded hover:bg-blue-100 dark:hover:bg-blue-800/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Clear All"})]})})]})]})}function m(e){let{settings:a,setSettings:t,isProcessing:s}=e,l=(e,a)=>{t(t=>({...t,[e]:a}))};return(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8 animate-slide-up",children:[(0,r.jsxs)("h3",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,r.jsx)("span",{className:"mr-3",children:"⚙️"}),"Processing Settings"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"md:col-span-2 lg:col-span-3",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"FreeImage Host API Key"}),(0,r.jsx)("input",{type:"password",value:a.freeImageApiKey,onChange:e=>l("freeImageApiKey",e.target.value),disabled:s,placeholder:"Enter your FreeImage Host API key",className:"w-full text-base p-3 border border-gray-300 dark:border-gray-600 rounded-lg  bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent disabled:opacity-50"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Required for image hosting. Get your free API key from"," ",(0,r.jsx)("a",{href:"https://freeimage.host/page/api",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"FreeImage Host"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Processing Mode"}),(0,r.jsxs)("select",{value:a.processingMode,onChange:e=>l("processingMode",e.target.value),disabled:s,className:"w-full text-base p-3 border border-gray-300 dark:border-gray-600 rounded-lg  bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent disabled:opacity-50",children:[(0,r.jsx)("option",{value:"sequential",children:"Sequential (Safer)"}),(0,r.jsx)("option",{value:"batch",children:"Batch Processing"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"OCR Quality"}),(0,r.jsxs)("select",{value:a.ocrQuality,onChange:e=>l("ocrQuality",e.target.value),disabled:s,className:"w-full text-base p-3 border border-gray-300 dark:border-gray-600 rounded-lg  bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent disabled:opacity-50",children:[(0,r.jsx)("option",{value:"fast",children:"Fast"}),(0,r.jsx)("option",{value:"balanced",children:"Balanced"}),(0,r.jsx)("option",{value:"accurate",children:"Accurate (Slower)"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Match Threshold"}),(0,r.jsxs)("select",{value:a.matchThreshold,onChange:e=>l("matchThreshold",parseFloat(e.target.value)),disabled:s,className:"w-full text-base p-3 border border-gray-300 dark:border-gray-600 rounded-lg  bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent disabled:opacity-50",children:[(0,r.jsx)("option",{value:.1,children:"Very Loose (0.1)"}),(0,r.jsx)("option",{value:.2,children:"Loose (0.2)"}),(0,r.jsx)("option",{value:.3,children:"Balanced (0.3)"}),(0,r.jsx)("option",{value:.4,children:"Strict (0.4)"}),(0,r.jsx)("option",{value:.5,children:"Very Strict (0.5)"})]})]})]}),(0,r.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:a.enableFallback,onChange:e=>l("enableFallback",e.target.checked),disabled:s,className:"mr-3 rounded focus:ring-primary"}),(0,r.jsx)("span",{className:"text-sm",children:"Enable database fallback matching"})]}),(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:a.fetchPrices,onChange:e=>l("fetchPrices",e.target.checked),disabled:s,className:"mr-3 rounded focus:ring-primary"}),(0,r.jsx)("span",{className:"text-sm",children:"Fetch current market prices"})]}),(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:a.saveDebugImages,onChange:e=>l("saveDebugImages",e.target.checked),disabled:s,className:"mr-3 rounded focus:ring-primary"}),(0,r.jsx)("span",{className:"text-sm",children:"Save debug preprocessed images"})]})]})]})}function g(e){let{isProcessing:a,currentImage:t,totalImages:l,processedCount:n,results:c,logs:d,onStart:i,onStop:o,canStart:m}=e,[g,h]=(0,s.useState)(0),[x,u]=(0,s.useState)("Calculating..."),[p,b]=(0,s.useState)(null),f=(0,s.useRef)(null);(0,s.useEffect)(()=>{a&&!p?b(Date.now()):a||b(null)},[a]),(0,s.useEffect)(()=>{if(a&&p&&n>0){let e=(Date.now()-p)/1e3/60,a=e>0?(n/e).toFixed(1):0;h(a);let t=l-n;if(0===t)u("Complete");else if(a>0){let e=t/a;u(e<1?"<1 min":"".concat(Math.round(e)," min"))}else u("Calculating...")}},[a,p,n,l]),(0,s.useEffect)(()=>{f.current&&(f.current.scrollTop=f.current.scrollHeight)},[d]);let y=l>0?n/l*100:0,j=c.filter(e=>e.matched).length,N=c.filter(e=>!e.matched).length;return(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8 animate-slide-up",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("h3",{className:"text-xl font-semibold flex items-center",children:[(0,r.jsx)("span",{className:"mr-3",children:"\uD83D\uDD04"}),"Processing Status"]}),(0,r.jsx)("div",{className:"flex gap-3",children:a?(0,r.jsx)("button",{onClick:o,className:"bg-red-500 text-white py-2 px-6 rounded-lg font-semibold  hover:bg-red-600 transition-colors shadow-lg hover:shadow-xl",children:"Stop Processing"}):(0,r.jsx)("button",{onClick:i,disabled:!m,className:"bg-primary text-white py-2 px-6 rounded-lg font-semibold  disabled:bg-gray-400 disabled:cursor-not-allowed hover:bg-purple-600  transition-colors shadow-lg hover:shadow-xl transform hover:scale-105 disabled:transform-none",children:"Start Processing"})})]}),(a||c.length>0)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:l}),(0,r.jsx)("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:"Total Images"})]}),(0,r.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:n}),(0,r.jsx)("div",{className:"text-sm text-green-800 dark:text-green-200",children:"Processed"})]}),(0,r.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:j}),(0,r.jsx)("div",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"Matched"})]}),(0,r.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:N}),(0,r.jsx)("div",{className:"text-sm text-red-800 dark:text-red-200",children:"Failed"})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,r.jsx)("span",{children:"Overall Progress"}),(0,r.jsxs)("span",{children:[Math.round(y),"%"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:(0,r.jsx)("div",{className:"bg-primary h-3 rounded-full transition-all duration-300",style:{width:"".concat(y,"%")}})}),a&&(0,r.jsxs)("div",{className:"flex justify-between text-sm mt-2 text-gray-600 dark:text-gray-400",children:[(0,r.jsxs)("span",{children:["Processing Rate: ",g," images/min"]}),(0,r.jsxs)("span",{children:["ETA: ",x]})]})]}),a&&t&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"spinner mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-blue-800 dark:text-blue-200",children:"Currently Processing"}),(0,r.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-300",children:t})]})]})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,r.jsx)("h4",{className:"text-lg font-medium",children:"Processing Log"}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:[d.length," entries"]})]}),(0,r.jsx)("div",{ref:f,className:"h-40 overflow-y-auto bg-gray-100 dark:bg-gray-900 p-4 rounded-lg font-mono text-sm border border-gray-200 dark:border-gray-700",children:0===d.length?(0,r.jsx)("div",{className:"text-gray-500 italic",children:"No logs yet..."}):d.map((e,a)=>(0,r.jsxs)("div",{className:"mb-1",children:[(0,r.jsxs)("span",{className:"text-gray-500",children:["[",e.timestamp,"]"]})," ",(0,r.jsx)("span",{className:"error"===e.type?"text-red-500":"success"===e.type?"text-green-500":"warning"===e.type?"text-yellow-500":"",children:e.message})]},a))})]})]})]})}function h(e){let{results:a}=e,[t,l]=(0,s.useState)("filename"),[n,c]=(0,s.useState)("all"),[d,o]=(0,s.useState)(""),m=(0,s.useMemo)(()=>({total:a.length,matched:a.filter(e=>e.matched).length,failed:a.filter(e=>!e.matched).length}),[a]),g=(0,s.useMemo)(()=>{let e=a;switch(d&&(e=e.filter(e=>e.filename.toLowerCase().includes(d.toLowerCase())||(e.cardName||"").toLowerCase().includes(d.toLowerCase())||(e.matchedName||"").toLowerCase().includes(d.toLowerCase()))),n){case"matched":e=e.filter(e=>e.matched);break;case"failed":e=e.filter(e=>!e.matched)}return e.sort((e,a)=>{switch(t){case"filename":return e.filename.localeCompare(a.filename);case"cardName":return(e.matchedName||e.cardName||"").localeCompare(a.matchedName||a.cardName||"");case"processingTime":return(e.processingTime||0)-(a.processingTime||0);default:return 0}}),e},[a,d,n,t]);return 0===a.length?null:(0,r.jsxs)("header",{className:"fixed z-50 sticky bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,r.jsxs)("div",{className:"sticky flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-xl font-semibold mb-2 flex items-center",children:[(0,r.jsx)("span",{className:"mr-3",children:"\uD83D\uDCCA"}),"Recognition Results"]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm",children:[(0,r.jsxs)("span",{className:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-3 py-1 rounded-full",children:["Total: ",m.total]}),(0,r.jsxs)("span",{className:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-3 py-1 rounded-full",children:["Matched: ",m.matched]}),(0,r.jsxs)("span",{className:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 px-3 py-1 rounded-full",children:["Failed: ",m.failed]})]})]}),(0,r.jsx)("div",{className:"mt-4 lg:mt-0",children:(0,r.jsx)("button",{onClick:()=>{if(0===a.length)return;let e=a.map(e=>{var a,t,r;return{Filename:e.filename,"Card Name":e.matchedName||e.cardName||"Unknown","Set Name":e.setName||"","Set Code":e.setCode||"",Edition:e.edition||"",Rarity:e.rarity||"",Condition:e.condition||"",Description:e.effectText||"","Image URL":e.imageUrl||"","eBay Price":(null===(a=e.prices)||void 0===a?void 0:a.ebay)||"0.00","TCGPlayer Price":(null===(t=e.prices)||void 0===t?void 0:t.tcgplayer)||"0.00","Cardmarket Price":(null===(r=e.prices)||void 0===r?void 0:r.cardmarket)||"0.00","Processing Time":e.processingTime?"".concat(e.processingTime,"ms"):"",Matched:e.matched?"Yes":"No"}}),t=new Blob([i().unparse(e)],{type:"text/csv"}),r=URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download="card_recognition_results_".concat(new Date().toISOString().split("T")[0],".csv"),s.click(),URL.revokeObjectURL(r)},className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-purple-600 transition-colors text-sm shadow-lg hover:shadow-xl transform hover:scale-105",children:"Export CSV"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,r.jsx)("div",{className:"md:col-span-2",children:(0,r.jsx)("input",{type:"text",placeholder:"Search by filename or card name...",value:d,onChange:e=>o(e.target.value),className:"w-full text-base p-3 border border-gray-300 dark:border-gray-600 rounded-lg  bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent"})}),(0,r.jsx)("div",{children:(0,r.jsxs)("select",{value:n,onChange:e=>c(e.target.value),className:"w-full text-base p-3 border border-gray-300 dark:border-gray-600 rounded-lg  bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent",children:[(0,r.jsx)("option",{value:"all",children:"All Results"}),(0,r.jsx)("option",{value:"matched",children:"Matched Only"}),(0,r.jsx)("option",{value:"failed",children:"Failed Only"})]})}),(0,r.jsx)("div",{children:(0,r.jsxs)("select",{value:t,onChange:e=>l(e.target.value),className:"w-full text-base p-3 border border-gray-300 dark:border-gray-600 rounded-lg  bg-white dark:bg-gray-700 focus:ring-2 focus:ring-primary focus:border-transparent",children:[(0,r.jsx)("option",{value:"filename",children:"Sort by Filename"}),(0,r.jsx)("option",{value:"cardName",children:"Sort by Card Name"}),(0,r.jsx)("option",{value:"processingTime",children:"Sort by Processing Time"})]})})]}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",g.length," of ",a.length," results"]})}),(0,r.jsx)("div",{className:"grid gap-4",children:g.map((e,a)=>(0,r.jsx)(x,{result:e},"".concat(e.filename,"-").concat(a)))}),0===g.length&&d&&(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsxs)("p",{className:"text-gray-500 dark:text-gray-400",children:['No results found for "',d,'"']}),(0,r.jsx)("button",{onClick:()=>o(""),className:"text-primary hover:underline mt-2",children:"Clear search"})]})]})}function x(e){let{result:a}=e,[t,l]=(0,s.useState)(!1);return(0,r.jsx)("div",{className:"max-h-[500px] z-0",children:(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600  hover:shadow-lg transition-all duration-300 hover:scale-[1.02] animate-fade-in",children:(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("div",{className:"flex-shrink-0",children:[a.imageUrl?(0,r.jsx)("img",{src:a.imageUrl,alt:a.filename,className:"w-24 h-32 object-cover rounded border shadow-sm hover:shadow-md transition-shadow cursor-pointer",onClick:()=>window.open(a.imageUrl,"_blank")}):(0,r.jsx)("div",{className:"w-24 h-32 bg-gray-200 dark:bg-gray-600 rounded border flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-gray-400 text-xs",children:"No Image"})}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1 truncate w-24",title:a.filename,children:a.filename})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,r.jsx)("h3",{className:"font-semibold truncate text-lg",children:a.matchedName||a.cardName||"Unknown Card"}),(0,r.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat(a.matched?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"),children:a.matched?"✅ Matched":"❌ Failed"})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83D\uDD0D"}),"OCR Detected Text"]}),(0,r.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded border border-blue-200 dark:border-blue-800",children:[(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-blue-700 dark:text-blue-300",children:"Card Name:"}),(0,r.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-200 mt-1",children:a.cardName||"Not detected"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs font-medium text-blue-700 dark:text-blue-300",children:"Effect Text:"}),(0,r.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-200 mt-1 ".concat(t?"":"line-clamp-2"),children:a.effectText||"Not detected"}),a.effectText&&a.effectText.length>100&&(0,r.jsx)("button",{className:"text-xs text-blue-600 hover:underline mt-1",onClick:()=>l(!t),children:t?"Show less":"Show more"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83C\uDFAF"}),"Database Match"]}),a.matched?(0,r.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded border border-green-200 dark:border-green-800",children:[(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-green-700 dark:text-green-300",children:"Matched Name:"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-green-800 dark:text-green-200 mt-1",children:a.matchedName})]}),a.setName&&(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-green-700 dark:text-green-300",children:"Set:"}),(0,r.jsx)("p",{className:"text-sm text-green-800 dark:text-green-200 mt-1",children:a.setName})]}),a.rarity&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs font-medium text-green-700 dark:text-green-300",children:"Rarity:"}),(0,r.jsx)("p",{className:"text-sm text-green-800 dark:text-green-200 mt-1",children:a.rarity})]})]}):(0,r.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded border border-yellow-200 dark:border-yellow-800",children:[(0,r.jsx)("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm",children:"No match found"}),(0,r.jsx)("p",{className:"text-xs text-yellow-600 dark:text-yellow-400 mt-1",children:"Card may be rare, damaged, or not in inventory"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Processing Time:"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:a.processingTime?"".concat(a.processingTime,"ms"):"Unknown"})]}),a.condition&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Condition:"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:a.condition})]}),a.edition&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Edition:"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:a.edition})]})]}),a.prices&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83D\uDCB0"}),"Current Market Prices"]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-2 rounded border",children:[(0,r.jsx)("span",{className:"text-gray-500",children:"eBay:"}),(0,r.jsxs)("p",{className:"font-semibold",children:["$",a.prices.ebay]})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-2 rounded border",children:[(0,r.jsx)("span",{className:"text-gray-500",children:"TCGPlayer:"}),(0,r.jsxs)("p",{className:"font-semibold",children:["$",a.prices.tcgplayer]})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-2 rounded border",children:[(0,r.jsx)("span",{className:"text-gray-500",children:"Cardmarket:"}),(0,r.jsxs)("p",{className:"font-semibold",children:["$",a.prices.cardmarket]})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[(0,r.jsx)("button",{className:"text-xs bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition-colors",children:"Edit Details"}),(0,r.jsx)("button",{className:"text-xs bg-gray-500 text-white px-3 py-1 rounded hover:bg-gray-600 transition-colors",children:"Re-process"}),a.matched&&(0,r.jsx)("button",{className:"text-xs bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 transition-colors",children:"Add to Inventory"})]})]})]})]})})})}async function u(){try{console.log("Loading card database...");let e=await fetch("https://db.ygoprodeck.com/api/v7/cardinfo.php"),a=(await e.json()).data.map(e=>{var a;return{name:e.name,desc:e.desc,type:e.type,race:e.race,archetype:e.archetype,atk:e.atk,def:e.def,level:e.level,set_codes:null===(a=e.card_sets)||void 0===a?void 0:a.map(e=>e.set_code)}});return console.log("Loaded ".concat(a.length," cards from database")),a}catch(e){return console.error("Failed to load card database:",e),[]}}async function p(e){try{var a;let t=await fetch("https://db.ygoprodeck.com/api/v7/cardinfo.php?name=".concat(encodeURIComponent(e))),r=await t.json(),s=null===(a=r.data[0])||void 0===a?void 0:a.card_prices[0];return{ebay:(null==s?void 0:s.ebay_price)||"0.00",tcgplayer:(null==s?void 0:s.tcgplayer_price)||"0.00",cardmarket:(null==s?void 0:s.cardmarket_price)||"0.00"}}catch(e){return{ebay:"0.00",tcgplayer:"0.00",cardmarket:"0.00"}}}var b=t(9755),f=t.n(b);let y={left:60,top:70,width:650,height:160},j={left:60,top:740,width:680,height:210};async function N(e,a,t){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4?arguments[4]:void 0;try{s&&s("\uD83D\uDD0D Running OCR for ".concat(t,"..."));let l=function(e,a){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=document.createElement("canvas"),s=r.getContext("2d");r.width=a.width,r.height=a.height,s.drawImage(e,a.left,a.top,a.width,a.height,0,0,a.width,a.height);let l=s.getImageData(0,0,r.width,r.height);return t?function(e){let a=e.data;for(let e=0;e<a.length;e+=4){let t=Math.round(.299*a[e]+.587*a[e+1]+.114*a[e+2])>140?255:0;a[e]=t,a[e+1]=t,a[e+2]=t}}(l):function(e){let a=e.data;for(let e=0;e<a.length;e+=4){let t=Math.round(.299*a[e]+.587*a[e+1]+.114*a[e+2])>120?255:0;a[e]=t,a[e+1]=t,a[e+2]=t}}(l),s.putImageData(l,0,0),r}(e,a,r),n=((await f().recognize(l,"eng",{...r?{tessedit_pageseg_mode:4}:{tessedit_pageseg_mode:6},logger:e=>{"recognizing text"===e.status&&s&&s("\uD83D\uDD0D OCR ".concat(t,": ").concat(Math.round(100*e.progress),"%"))}})).data.text||"").replace(/[^\w\s\-,'']/g,"").replace(/\s+/g," ").trim();return s&&s("✅ OCR ".concat(t,' result: "').concat(n,'"')),n}catch(e){return console.error("OCR failed for ".concat(t,":"),e),s&&s("❌ OCR failed for ".concat(t,": ").concat(e.message)),""}}async function v(e,a,t){if(!a)throw Error("FreeImage API key is required");let r=new FormData;r.append("key",a),r.append("action","upload"),r.append("format","json"),r.append("source",e,t);let s=await fetch("https://freeimage.host/api/1/upload",{method:"POST",body:r}),l=await s.json();if(!s.ok||200!==l.status_code){var n,c,d;throw console.error(l),Error("FreeImage upload failed: ".concat((null==l?void 0:null===(c=l.image)||void 0===c?void 0:null===(n=c.error)||void 0===n?void 0:n.message)||(null==l?void 0:null===(d=l.error)||void 0===d?void 0:d.message)||"Unknown error"))}if(!l.image||!l.image.url)throw Error("FreeImage upload response missing image URL");return l.image.url}var w=t(9386);async function k(e,a,t,r,s){let l=Date.now();try{s("\uD83D\uDD0D Processing ".concat(e.name,"..."));let n=await new Promise((a,t)=>{let r=new Image,s=document.createElement("canvas"),l=s.getContext("2d");r.onload=()=>{let e=800/r.width;s.width=800,s.height=r.height*e,l.drawImage(r,0,0,s.width,s.height),a(s)},r.onerror=()=>{t(Error("Failed to load image: ".concat(e.name)))},r.src=URL.createObjectURL(e)});if(!n)throw s("❌ Failed to create canvas for ".concat(e.name)),Error("Canvas creation failed");let c=await N(n,y,"Card Name",!0,s);s('\uD83D\uDD20 OCR Name Result: "'.concat(c,'"'));let d=await N(n,j,"Effect Text",!1,s);if(s('\uD83E\uDDFE OCR Effect Result: "'.concat(d,'"')),!c||""===c.trim())throw s("❌ No card name text detected in ".concat(e.name)),Error("No card name detected");let i=function(e,a,t){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.2;if(!t||0===t.length)return[];let s=t.map((e,a)=>({index:a,row:e,cardName:(e[0]||"").trim(),setName:(e[1]||"").trim(),setCode:(e[2]||"").trim(),description:(e[6]||"").trim()})),l=new w.Z(s,{keys:[{name:"cardName",weight:.8},{name:"setCode",weight:.1},{name:"description",weight:.7}],includeScore:!0,threshold:r}),n="".concat(e," ").concat(a.slice(0,50)),c=l.search(n);if(0===c.length)return[];let d=c[0].item;return t.filter(e=>(e[0]||"").trim().toLowerCase()===d.cardName.toLowerCase())}(c,d,a,r.matchThreshold);s("\uD83D\uDCC8 Inventory Matches Found: ".concat(i.length));let o=i,m=c;if(0===o.length&&r.enableFallback){s("\uD83D\uDD04 Trying fallback match...");let e=function(e,a,t,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.4;if(!t||0===t.length||!r||0===r.length)return null;let l=e=>e.toLowerCase().replace(/[^\w\s\-]/g,"").replace(/\s+/g," ").trim(),n=new w.Z(t,{keys:["name","desc"],includeScore:!0,threshold:s}).search(e).slice(0,80),c=null,d=-1;for(let{item:e}of n){let t=function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=l(e).split(" "),s=l(a),n=0;for(let e=0;e<=r.length-t;e++){let a=r.slice(e,e+t).join(" ");s.includes(a)&&n++}return n}(a,e.desc||"");t>d&&(d=t,c=e)}if(!c)return null;let i=r.filter(e=>(e[0]||"").trim().toLowerCase()===c.name.trim().toLowerCase());return 0===i.length?(console.warn('⚠️ Fallback matched DB card "'.concat(c.name,'" not in inventory.')),null):(console.log('✅ Fallback matched: "'.concat(c.name,'" via chunked description.')),{matchedName:c.name,matchedRows:i})}(c,d,t,a);e&&e.matchedRows.length>0?(o=e.matchedRows,m=e.matchedName,s("✅ Fallback match succeeded: ".concat(m))):s("⚠️ Fallback failed")}let g="",h=null;if(o.length>0&&r.freeImageApiKey)try{let a=await function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8;return new Promise(t=>{e.toBlob(t,"image/jpeg",a)})}(n);g=await v(a,r.freeImageApiKey,e.name),s("\uD83D\uDCE4 Uploaded image URL: ".concat(g))}catch(e){s("⚠️ Upload error: ".concat(e.message))}if(o.length>0&&r.fetchPrices)try{h=await p(m),s("\uD83D\uDCB0 Prices fetched for ".concat(m))}catch(e){s("⚠️ Price fetch error: ".concat(e.message))}let x=Date.now()-l,u=o.length>0;return{filename:e.name,cardName:c,effectText:d,matched:u,matchedName:u?m:null,matchedRows:o,imageUrl:g,prices:h,processingTime:x,setName:u&&o[0]?o[0][1]:"",setCode:u&&o[0]?o[0][2]:"",edition:u&&o[0]?o[0][3]:"",rarity:u&&o[0]?o[0][4]:"",condition:u&&o[0]?o[0][5]:""}}catch(t){let a=Date.now()-l;return s("❌ Exception thrown for ".concat(e.name,": ").concat(t.message)),{filename:e.name,cardName:"",effectText:"",matched:!1,matchedName:null,matchedRows:[],imageUrl:"",prices:null,processingTime:a,error:t.message}}}function C(){let[e,a]=(0,s.useState)([]),[t,l]=(0,s.useState)([]),[d,i]=(0,s.useState)([]),[x,p]=(0,s.useState)([]),[b,f]=(0,s.useState)(!1),[y,j]=(0,s.useState)(""),[N,v]=(0,s.useState)(0),[w,C]=(0,s.useState)([]),D=(0,s.useRef)(!1),[S,P]=(0,s.useState)({freeImageApiKey:"6d207e02198a847aa98d0a2a901485a5",processingMode:"sequential",ocrQuality:"balanced",matchThreshold:.2,enableFallback:!0,fetchPrices:!0,saveDebugImages:!1});(0,s.useEffect)(()=>{(async()=>{try{R("Loading card database...","info");let e=await u();i(e),R("✅ Loaded ".concat(e.length," cards from database"),"success")}catch(e){R("❌ Failed to load card database: ".concat(e.message),"error")}})()},[]);let R=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=new Date().toLocaleTimeString();C(r=>[...r,{timestamp:t,message:e,type:a}]),console.log("[".concat(t,"] ").concat(e))},T=()=>{C([])},F=e.length>0&&""!==S.freeImageApiKey.trim(),I=async()=>{if(!F){R("❌ Cannot start: Need images and API key","error");return}f(!0),D.current=!1,p([]),v(0),T(),R("\uD83D\uDE80 Starting processing of ".concat(e.length," images"),"info"),R("Settings: ".concat(S.processingMode," mode, threshold: ").concat(S.matchThreshold),"info");let a=[];try{for(let r=0;r<e.length&&!D.current;r++){let s=e[r];j(s.name),R("\uD83D\uDCF8 Processing ".concat(r+1,"/").concat(e.length,": ").concat(s.name),"info");try{let e=await k(s,t,d,S,e=>R(e,"info"));if(!e){R("⚠️ No result returned for ".concat(s.name),"warning");continue}a.push(e),p(a=>[...a,e]),e.matched?R("✅ ".concat(s.name," matched: ").concat(e.matchedName),"success"):R("⚠️ ".concat(s.name," - no match found"),"warning"),v(r+1)}catch(t){R("❌ Error processing ".concat(s.name,": ").concat(t.message),"error");let e={filename:s.name,cardName:"",effectText:"",matched:!1,matchedName:null,matchedRows:[],imageUrl:"",prices:null,processingTime:0,error:t.message};a.push(e),p(a=>[...a,e]),v(r+1)}r<e.length-1&&await new Promise(e=>setTimeout(e,500))}let r=a.filter(e=>e.matched).length,s=a.filter(e=>!e.matched).length;R("\uD83C\uDF89 Processing completed!","success"),R("Results: ".concat(a.length," processed, ").concat(r," matched, ").concat(s," failed"),"info")}catch(e){R("❌ Processing error: ".concat(e.message),"error")}finally{f(!1),j("")}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n(),{children:[(0,r.jsx)("title",{children:"Yu-Gi-Oh Card Recognition - AI-Powered Card Scanner"}),(0,r.jsx)("meta",{name:"description",content:"Upload Yu-Gi-Oh card images to automatically recognize and match them against your inventory using advanced OCR technology"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)("div",{className:"bg-bg-light dark:bg-bg-dark text-gray-900 dark:text-white min-h-screen transition-colors",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[(0,r.jsx)(c,{}),(0,r.jsx)(o,{uploadedImages:e,setUploadedImages:a,inventory:t,setInventory:l,isProcessing:b}),(0,r.jsx)(m,{settings:S,setSettings:P,isProcessing:b}),(0,r.jsx)(g,{isProcessing:b,currentImage:y,totalImages:e.length,processedCount:N,results:x,logs:w,onStart:I,onStop:()=>{D.current=!0,f(!1),j(""),R("⏹️ Processing stopped by user","warning")},canStart:F}),(0,r.jsx)("div",{className:"container h-[500px] w-full overflow y-auto overflow-x-hidden p-2 m-2 mx-auto",children:(0,r.jsx)(h,{results:x})})]})})]})}}},function(e){e.O(0,[526,888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);